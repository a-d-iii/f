---
import HeartButton from './HeartButton.tsx';
const { faculty } = Astro.props;
const photoUrl = faculty.photo_url || faculty.photo;
const specializationRaw =
  faculty.specialization ||
  faculty.specialisation ||
  faculty.specializations ||
  faculty.dept ||
  faculty.department;

let specialization = specializationRaw;
if (specializationRaw) {
  const words = specializationRaw.split(/\s+/);
  if (words.length > 12) {
    specialization = words.slice(0, 12).join(' ') + '...';
  }
}

const teachingCount =
  faculty.num_teaching_ratings ?? faculty.numTeachingRatings ?? faculty.ratingsCount ?? faculty.total_ratings ?? null;
const attendanceCount =
  faculty.num_attendance_ratings ?? faculty.numAttendanceRatings ?? faculty.ratingsCount ?? faculty.total_ratings ?? null;
const correctionCount =
  faculty.num_correction_ratings ?? faculty.numCorrectionRatings ?? faculty.ratingsCount ?? faculty.total_ratings ?? null;

---
<article class="max-w-sm w-full bg-white/5 border border-white/20 backdrop-blur-lg rounded-2xl p-6 flex flex-col gap-4">
  <div class="flex gap-4">
    <img
      src={photoUrl}
      alt={`Photo of ${faculty.name || 'Unknown'}`}
      loading="lazy"
      onerror="this.src='https://placehold.co/300x400?text=No+Photo';this.onerror=null;"
      class="w-20 h-20 object-cover rounded-lg dark:border-2 dark:border-[#1E2230]"
    />
    <div class="flex flex-col flex-1 overflow-hidden">
      <h3 class="text-2xl font-medium text-gray-900 dark:text-[#E4E9F0] clamp-two-lines font-poppins">{faculty.name || 'Unknown'}</h3>
      {specialization && (
        <p class="italic text-gray-600 dark:text-[#CDD2E0] leading-snug mt-1 clamp-four-lines font-segoe">
          {specialization}
        </p>
      )}
    </div>
  </div>
  <div class="flex gap-4">
    <button class="w-16 h-16 rounded-lg border-2 border-[#FF00C8] text-[#FF00C8] flex flex-col items-center justify-center text-sm hover:bg-[#FF00C8]/20 hover:shadow-[0_0_10px_#FF00C8] transition">Teaching</button>
    <button class="w-16 h-16 rounded-lg border-2 border-[#00FFD8] text-[#00FFD8] flex flex-col items-center justify-center text-sm hover:bg-[#00FFD8]/20 hover:shadow-[0_0_10px_#00FFD8] transition">Attendance</button>
    <button class="w-16 h-16 rounded-lg border-2 border-[#FFD500] text-[#FFD500] flex flex-col items-center justify-center text-sm hover:bg-[#FFD500]/20 hover:shadow-[0_0_10px_#FFD500] transition">Correction</button>
  </div>
  <button class="mt-2 w-full h-12 rounded-full border border-[#00FFD8] text-[#00FFD8] hover:bg-white/10 transition">Rate</button>
  <HeartButton client:visible />
</article>
